<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Gatling Reports</title>
    <style>
        html {
            font-family: sans-serif;
            width: 100%;
            height: 100%;
            background: white;
        }

        body {
            font-family: sans-serif;
            width: 50%;
            height: 100%;
            inset: 0;
            position: absolute;
            left: 25%;
            padding: 1em;
        }

        h1 {
            text-align: center;
        }

        ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        li {
            float: left;
        }

        li a {
            display: block;
            color: #000;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
        }

        li a:hover {
            background-color: #555;
            color: white;
        }
    </style>
</head>
<body>
<h1>Gatling-Reports</h1>
<h2>Core</h2>
<ul id="gatling-it-core"></ul>
<h2>Persistence</h2>
<ul id="gatling-it-persistence"></ul>

<script>
    // Benutzername, Repositoryname, Branch und zus채tzliche Ordnerschicht
    var username = "HexxagonHTWG";
    var repository = "Hexxagon";
    var branch = "gatling-reports";
    var folderLayers = ["gatling-it-core", "gatling-it-persistence"];

    folderLayers.forEach(folderLayer => {
        // API-URL f체r Ordnerstruktur auf einem bestimmten Branch und in der zus채tzlichen Ordnerschicht
        var apiUrl = "https://api.github.com/repos/" + username + "/" + repository + "/contents/" + folderLayer + "?ref=" + branch;

        // GitHub API anfragen
        fetch(apiUrl)
            .then(response => response.json())
            .then(data => {
                // Durchlaufe die API-Antwort und erstelle Links f체r Ordner
                data.sort((item1, item2) => {
                    if (item1.type === "dir") {
                        // sort by date
                        const rawName = item1.name;
                        const folderNames = rawName.split("-");
                        const year = folderNames[1].substring(0, 4);
                        const month = folderNames[1].substring(4, 6);
                        const day = folderNames[1].substring(6, 8);
                        const hour = folderNames[1].substring(8, 10);
                        const minute = folderNames[1].substring(10, 12);
                        const second = folderNames[1].substring(12, 14);
                        const date = new Date(
                            year,
                            month - 1,
                            day,
                            hour,
                            minute,
                            second
                        );
                        // sort by date
                        const rawName2 = item2.name;
                        const folderNames2 = rawName2.split("-");
                        const year2 = folderNames2[1].substring(0, 4);
                        const month2 = folderNames2[1].substring(4, 6);
                        const day2 = folderNames2[1].substring(6, 8);
                        const hour2 = folderNames2[1].substring(8, 10);
                        const minute2 = folderNames2[1].substring(10, 12);
                        const second2 = folderNames2[1].substring(12, 14);
                        const date2 = new Date(
                            year2,
                            month2 - 1,
                            day2,
                            hour2,
                            minute2,
                            second2
                        );
                        return date2 - date;
                    }
                }).forEach(item => {
                    if (item.type === "dir") {
                        const rawName = item.name;
                        const folderNames = rawName.split("-");
                        const folderName = folderNames[0];
                        const year = folderNames[1].substring(0, 4);
                        const month = folderNames[1].substring(4, 6);
                        const day = folderNames[1].substring(6, 8);
                        const hour = folderNames[1].substring(8, 10);
                        const minute = folderNames[1].substring(10, 12);
                        const second = folderNames[1].substring(12, 14);
                        const date = new Date(
                            year,
                            month - 1,
                            day,
                            hour,
                            minute,
                            second
                        );
                        const folderLink = document.createElement("a");
                        folderLink.href = "./" + folderLayer + "/" + rawName + "/";
                        folderLink.textContent = folderName + " - " + date.toLocaleString();

                        const listItem = document.createElement("li");
                        listItem.appendChild(folderLink);
                        document.getElementById(folderLayer).appendChild(listItem);
                    }
                });
            });
    });
</script>
</body>
</html>
